/*
 * Copyright (C) 2014  Andrew Gunnerson <andrewgunnerson@gmail.com>
 *
 * This file is part of MultiBootPatcher
 *
 * MultiBootPatcher is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * MultiBootPatcher is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with MultiBootPatcher.  If not, see <http://www.gnu.org/licenses/>.
 */

#include "validcerts.h"

/*
 * Android's "signatures" in /data/system/packages.xml and also in the Java
 * class android.content.pm.Signature are just hexadecimal representations of
 * the signing key's certificate.
 *
 * To get this "signature" from the keystore, run the following command:
 *
 *   $ keytool -alias YOUR_KEY_ALIAS -keystore YOUR_KEYSTORE_FILE -exportcert \
 *         | hexdump -ve '1/1 "%.2x"'; echo
 */

// Certificate for official releases
#define RELEASE_CERT "3082032930820211a00302010202042eab8dd1300d06092a864886f70d01010b05003045310b3009060355040613025553310d300b060355040813044f68696f310e300c06035504071305536f6c6f6e311730150603550403130e5869616f2d4c6f6e67204368656e301e170d3133303930373230343730345a170d3135303930373230343730345a3045310b3009060355040613025553310d300b060355040813044f68696f310e300c06035504071305536f6c6f6e311730150603550403130e5869616f2d4c6f6e67204368656e30820122300d06092a864886f70d01010105000382010f003082010a02820101009b0cdb622c8e39449bc8e1751e866122ba8e61b8683ff160bf2d874c087a22329dca1a253c06799940714be28918bdc3c3c326ca42d7e226723cbe3d480e85628611355f1d5ba1cf451def8f79edaea652aef238e0d1d7661dc7bf666e8591ec901f266d34ba64d8e455f5b810bd11755f1500f0d98f8c98cffc2baaf7e3540275313497fd009615a79f7b9f60d969a26c3abd28e03034d4f843bb5579c6053c6367f4b8dd6f1df6b0b6766586ae902e6b932cc7924f18cdcaecfebc01283cd32e4586e88cdc3463dbeefe7afb19b680dc4607951382c7c3509cabc3745ef48a2ff5da4545be600b126b4cafc280a836499e743d105da8309658934970c487f90203010001a321301f301d0603551d0e0416041496187394f9848ce0de6ce6bdf443413c191e0b43300d06092a864886f70d01010b05000382010100415dbd9fbe93380febcb9822a237cb04549390d4daab6072219e6904f60c2dbc063f42602b52eba29996c36ac958d5a152b2d9d5d3e5a6d95e73825468c921dd0a281655ceb6cbb88412b046c15057fb600feb729d36e08aa1077e9c82388a3719ef144866b25777a493e7f696211eebbf7d368a5b751435faea7545a8f98045a6bca63f3985e98a9b90882c2f0701421aa30330df4b71770178cc71600f8d9808536381587eab7400d21edca77d206d5b7b5b570bcb051b28d34c389b636da9e77d2ccaa9e1d1476bde5f721fdc54993f96cc77d868916dbff0b7b02a012421fb7e8f18d5948fa478df783df49dcc6eef37e0168997afd9fd899a27d13819ee"
// Certificate for continuous integration snapshots
#define CI_CERT      "3082034830820306a003020102020424e12b8f300b06072a8648ce38040305003076310b30090603550406130255533110300e06035504081307556e6b6e6f776e3110300e06035504071307556e6b6e6f776e3110300e060355040a1307556e6b6e6f776e3110300e060355040b1307556e6b6e6f776e311f301d060355040313164a656e6b696e73204349204175746f4275696c646572301e170d3135303231353232343932325a170d3135303531363232343932325a3076310b30090603550406130255533110300e06035504081307556e6b6e6f776e3110300e06035504071307556e6b6e6f776e3110300e060355040a1307556e6b6e6f776e3110300e060355040b1307556e6b6e6f776e311f301d060355040313164a656e6b696e73204349204175746f4275696c646572308201b73082012c06072a8648ce3804013082011f02818100fd7f53811d75122952df4a9c2eece4e7f611b7523cef4400c31e3f80b6512669455d402251fb593d8d58fabfc5f5ba30f6cb9b556cd7813b801d346ff26660b76b9950a5a49f9fe8047b1022c24fbba9d7feb7c61bf83b57e7c6a8a6150f04fb83f6d3c51ec3023554135a169132f675f3ae2b61d72aeff22203199dd14801c70215009760508f15230bccb292b982a2eb840bf0581cf502818100f7e1a085d69b3ddecbbcab5c36b857b97994afbbfa3aea82f9574c0b3d0782675159578ebad4594fe67107108180b449167123e84c281613b7cf09328cc8a6e13c167a8b547c8d28e0a3ae1e2bb3a675916ea37f0bfa213562f1fb627a01243bcca4f1bea8519089a883dfe15ae59f06928b665e807b552564014c3bfecf492a0381840002818045be19d705e6784c709780fc771d6682ad76846105afdc6d80423d171855f8a0d11b004178718835869a8c983f0303a640ae87d5907e6efc22a556512eda20eb41410dbef88ece9956081052a4cf625f8bd6377e2dfc72ec8d4b92740b9f70881c18cc849d148d8fef3c4995841d01653702e628eb420be3a9a46188999f33c8a321301f301d0603551d0e04160414010db3b5bae1c5ca67d223c0cb049253ff0315d8300b06072a8648ce3804030500032f00302c02142de739e45f1ed338c2570a4ababbd8cb081fd07a021425a16318d011850dcd7548cb30a48b2c8248f5c6"
// Certificate for default Android debug key
#ifdef ALLOW_DEBUG_CERT
#warning *** Debug certificate allowed! ***
#define DEBUG_CERT   "3082030d308201f5a003020102020472a96cde300d06092a864886f70d01010b05003037310b30090603550406130255533110300e060355040a1307416e64726f6964311630140603550403130d416e64726f6964204465627567301e170d3134313030323034303632365a170d3434303932343034303632365a3037310b30090603550406130255533110300e060355040a1307416e64726f6964311630140603550403130d416e64726f696420446562756730820122300d06092a864886f70d01010105000382010f003082010a0282010100a4127ea8964c49c4a67ba9a26a770182d5a246f6c630c7a9c18463cffc01a8e54a4b246c26d2e9b43c18803171888925db469734a95d87572cb5970320cfc2b0aef864c67505930b7a0b28ea8b00ffcef9966167342c6b34c779e43894346d11b312d66f79a76c61c84df1eadf0a33dc83e91734b199562fbcd8ebfc8cac0d5e9d1daff5d5d00f868e4f308df0b0389249c96cdc1accb59388e10e1e99adc55b8dbdb9e3e2e3cfafd3b0ffde2b2ca5b2cbeefbd5d6bb9571f9208f1f99c10426b22bbede5f1e7169eb32ad775e7d6d3039feac14494641e628b8633ac7b5c6c5e0c12ae5af2e716cc5e33f46a0f9966fd9a7e763c2b5c4bb9de05aebce4a3e470203010001a321301f301d0603551d0e041604143780552e112a738bb58d36df665954c9de3b0587300d06092a864886f70d01010b050003820101003c02d2df2907b3e43727912b0d590028b397a8d82cb83c259fd3f58503cb4ef35c9aadbdbe34713053ccd8d5f158cc0189db90f9a19cd0c0e2b762c07b6737e0903c4af2bf9bc3c9329c994fc06982806d58656e7d3b6dc8bb4abe0629a099d546d1291b27477c7776feeda85008f986e04951b965ee9147fb06d71910f81dbf456a6883205399225c36402b39fae1f32cfc90bb07426677af0f17656d3022f8f4efc17f9c08353db8978952a4b79775fa119ea4d2096435d00ddcead21eb06107657d697619b33e23073ffec0d73186d85bbc24c329140c609b7ee315c0d50225571115657b36f684b5dc49161613bc73cefabfc00644b38484f52d273bc49b"
#endif

std::vector<std::string> valid_certs{
    RELEASE_CERT,
    CI_CERT,
#ifdef ALLOW_DEBUG_CERT
    DEBUG_CERT
#endif
};